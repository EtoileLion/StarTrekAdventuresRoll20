<input type="checkbox" name="attr_use_background" value="0" class="sheet-white sheet-noshow" role="presentation" />
<input type="checkbox" name="attr_use_background" value="1" class="sheet-blue sheet-noshow" role="presentation" />
<input type="checkbox" name="attr_use_background" value="2" class="sheet-black sheet-noshow" role="presentation" />
<div class="wrapper">
<input class="character_type" name="attr_character_type" type="hidden" value="character">
<input class="settings_toggle" name="attr_settings_toggle" type="hidden" value="off"/>    
<div class="topback character">
    <div class="topsection">
        <div class="sheet-controls">
            <input type="checkbox" name="attr_show_settings" title="Sheet Settings & Notes"/><span>y</span>
            <h1>STARFLEET PERSONNEL FILE</h1>
        </div>
        <div class='charinfo'>
            <div class="charinfocontainer">
                <span class="label">NAME:</span><input type="text" name="attr_character_name"/>
            </div>
            <div class="sheet-2colrow">
                <div class="sheet-col">
                    <div class="charinfocontainer">
                        <span class="label">SPECIES:</span><input type="text" name="attr_species"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">ENVIRONMENT:</span><input type="text" name="attr_environment"/>
                    </div>
                </div>
                <div class="sheet-col">
                    <div class="charinfocontainer">
                        <span class="label">RANK:</span><input type="text" name="attr_rank"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">UPBRINGING:</span><input type="text" name="attr_upbringing"/>
                    </div>
                </div>
            </div>
            <div class="charinfocontainer">
                <span class="label">ASSIGNMENT:</span><input type="text" name="attr_assignment"/>
            </div>
            <div class="charinfocontainer">
                <span class="label">TRAITS:</span><input type="text" name="attr_traits" /><br /><input type='text' name='attr_extra_traits' />
            </div>
        </div>
    </div>
</div>
<div class="topback starship">
    <div class="topsection">
        <div class="sheet-controls">
            <input type="checkbox" name="attr_show_settings" title="Sheet Settings & Notes"/><span>y</span>
            <h1>STARSHIP REGISTRY ENTRY</h1>
        </div>
        <div class='charinfo'>
            <div class="sheet-2colrow">
                <div class="sheet-col">
                    <div class="charinfocontainer">
                        <span class="label">NAME:</span><input type="text" name="attr_character_name"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">SERVICE DATE:</span><input type="text" name="attr_service_date"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">MISSION PROFILE:</span><input type="text" name="attr_mission_profile"/>
                    </div>
                </div>
                <div class="sheet-col">
                    <div class="charinfocontainer">
                        <span class="label">DESIGNATION:</span><input type="text" name="attr_designation"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">SPACE FRAME:</span><input type="text" name="attr_space_frame"/>
                    </div>
                    <div class="charinfocontainer">
                        <span class="label">REFIT:</span><input type="text" name="attr_refit"/>
                    </div>
                </div>
            </div>
			<div class="charinfocontainer">
                <span class="label">TRAITS:</span><input type="text" name="attr_starship_traits"/><br /><input type='text' name='attr_extra_starship_traits' />
            </div>
        </div>
    </div>
</div>
<div class="topback settings">
    <div class="topsection">
        <div class="sheet-controls">
            <input type="checkbox" name="attr_show_settings" title="Sheet Settings & Notes"/><span>y</span>
            <h1>SHEET SETTINGS</h1>
        </div>
        <div class="sheet-row" style="width: 100%;">
            <div class="sheet-col" style="margin-right: 60px; width: 45%">
                <div class="sectionheader">
                    <span class="label">SHEET TYPE</span>
                </div>
                <div class="attributecontainer">
                    <select name="attr_header_text">
                        <option value="character">STARFLEET PERSONNEL FILE</option>
                        <option value="starship">STARSHIP REGISTRY ENTRY</option>
                    </select>
                </div>
                <div class="sectionheader">
                    <span class="label">SHEET THEME</span>
                </div>
                <div class="attributecontainer">
                    <select name="attr_use_background">
						<option value="0">White and Bright</option>
						<option value="1">Blue Balls</option>
						<option value="2">LCARS Standard</option>
					</select>
                </div>
            </div>
            <div class="sheet-col">
                <div class="sheet-stress_settings">
                    <div class="sectionheader">
                        <span class="label">STRESS</span>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <span class="label">CURRENT</span><input type="number" min=0 name="attr_stress" value="0">
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <span class="label">BONUS</span><input type="number" min=0 name="attr_stress_bonus" value="0">
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <span class="label">MAX</span><input type="number" min=0 name="attr_stress_max" disabled="true" value="(@{fitness} + @{security} + @{stress_bonus})"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-shields_settings">
                    <div class="sectionheader">
                        <span class="label">SHIELDS</span>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <span class="label">CURRENT</span><input type="number" min=0 name="attr_shields" value="0">
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <span class="label">BONUS</span><input type="number" name="attr_shields_bonus" value="0">
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <span class="label">MAX</span><input type="number" min=0 name="attr_shields_max" disabled="true" value="(@{ship_structure} + @{ship_security} + @{shields_bonus})"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sheet-power_settings">
                    <div class="sectionheader">
                        <span class="label">POWER</span>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <span class="label">BONUS</span><input type="number" name="attr_power_bonus" value="0">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="vertdeco"></div>
<div class="sidedeco1"></div>
<div class="sidedeco2"></div>
<div class="bottomback settings">
    <div class="bottomsection">
        <div class="instructions" style="padding-right: 10px;">
            <div class="sectionheader">
                <span class="label">SHEET VERSION</span>
            </div>
            <div class="attributecontainer">
                <input type="hidden" name="attr_version"/>
                <span class="label" title="SHEET VERSION">VERSION</span><input type="number" name="attr_disp_version" disabled="true" value="@{version}"/>
            </div>
        </div>
        <div class="additional-notes" style="padding-right: 10px;">
            <div class="sectionheader">
                <span class="label">ADDITIONAL NOTES</span>
            </div>
            <textarea name="attr_More_add_Notes"></textarea>
        </div>
        <div class="legal">
            &trade; & &copy; 2017 CBS Studios Inc. &copy; 2017 Paramount Pictures Corp. STAR TREK and related marks and logos are trademarks of CBS Studios Inc. All Rights Reserved.
        </div>
    </div>
    <div class='spacer'></div>
</div>
<div class="bottomback character">
    <div class="bottomsection">
        <div class="sheet-row">
            <div class="sheet-col" style="margin: 0px;">
                <div class='attributes'>
                    <div class="sectionheader">
                        <span class="label">ATTRIBUTES</span>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_control' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Control&#34;,&#34;attrv&#34;:@{control},&#34;disc&#34;:?{Select a Discipline|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                   <span>CONTROL</span>
                                </button>
                                <input name="attr_control" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_fitness' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Fitness&#34;,&#34;attrv&#34;:@{fitness},&#34;disc&#34;:?{Select a Discipline|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>FITNESS</span>
                                </button>
                                <input name="attr_fitness" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_presence' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Presence&#34;,&#34;attrv&#34;:@{presence},&#34;disc&#34;:?{Select a Discipline|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>PRESENCE</span>
                                </button>
                                <input name="attr_presence" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px;">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_daring' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Daring&#34;,&#34;attrv&#34;:@{daring},&#34;disc&#34;:?{Select a Discipline|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>DARING</span>
                                </button>
                                <input name="attr_daring" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_insight' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Insight&#34;,&#34;attrv&#34;:@{insight},&#34;disc&#34;:?{Select a Discipline|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>INSIGHT</span>
                                </button>
                                <input name="attr_insight" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_reason' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Reason&#34;,&#34;attrv&#34;:@{reason},&#34;disc&#34;:?{Select a Discipline|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>REASON</span>
                                </button>
                                <input name="attr_reason" type="number" min=7 max=12 value="7"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='disciplines'>
                    <div class="sectionheader">
                        <span class="label">DISCIPLINES</span>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_command' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Command&#34;,&#34;discv&#34;:@{command},&#34;attr&#34;:?{Select an Attribute|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Control, &#34;Control&#34;&amp;#44;&#34;attrv&#34;&#58;@{control}|Daring, &#34;Daring&#34;&amp;#44;&#34;attrv&#34;&#58;@{daring}|Fitness, &#34;Fitness&#34;&amp;#44;&#34;attrv&#34;&#58;@{fitness}|Insight, &#34;Insight&#34;&amp;#44;&#34;attrv&#34;&#58;@{insight}|Presence, &#34;Presence&#34;&amp;#44;&#34;attrv&#34;&#58;@{presence}|Reason, &#34;Reason&#34;&amp;#44;&#34;attrv&#34;&#58;@{reason}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>COMMAND</span>
                                </button>
                                <input name="attr_command" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_security' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Security&#34;,&#34;discv&#34;:@{security},&#34;attr&#34;:?{Select an Attribute|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Control, &#34;Control&#34;&amp;#44;&#34;attrv&#34;&#58;@{control}|Daring, &#34;Daring&#34;&amp;#44;&#34;attrv&#34;&#58;@{daring}|Fitness, &#34;Fitness&#34;&amp;#44;&#34;attrv&#34;&#58;@{fitness}|Insight, &#34;Insight&#34;&amp;#44;&#34;attrv&#34;&#58;@{insight}|Presence, &#34;Presence&#34;&amp;#44;&#34;attrv&#34;&#58;@{presence}|Reason, &#34;Reason&#34;&amp;#44;&#34;attrv&#34;&#58;@{reason}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>SECURITY</span>
                                </button>
                                <input name="attr_security" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_science' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Science&#34;,&#34;discv&#34;:@{science},&#34;attr&#34;:?{Select an Attribute|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Control, &#34;Control&#34;&amp;#44;&#34;attrv&#34;&#58;@{control}|Daring, &#34;Daring&#34;&amp;#44;&#34;attrv&#34;&#58;@{daring}|Fitness, &#34;Fitness&#34;&amp;#44;&#34;attrv&#34;&#58;@{fitness}|Insight, &#34;Insight&#34;&amp;#44;&#34;attrv&#34;&#58;@{insight}|Presence, &#34;Presence&#34;&amp;#44;&#34;attrv&#34;&#58;@{presence}|Reason, &#34;Reason&#34;&amp;#44;&#34;attrv&#34;&#58;@{reason}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>SCIENCE</span>
                                </button>
                                <input name="attr_science" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px;">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_conn' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Conn&#34;,&#34;discv&#34;:@{conn},&#34;attr&#34;:?{Select an Attribute|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Control, &#34;Control&#34;&amp;#44;&#34;attrv&#34;&#58;@{control}|Daring, &#34;Daring&#34;&amp;#44;&#34;attrv&#34;&#58;@{daring}|Fitness, &#34;Fitness&#34;&amp;#44;&#34;attrv&#34;&#58;@{fitness}|Insight, &#34;Insight&#34;&amp;#44;&#34;attrv&#34;&#58;@{insight}|Presence, &#34;Presence&#34;&amp;#44;&#34;attrv&#34;&#58;@{presence}|Reason, &#34;Reason&#34;&amp;#44;&#34;attrv&#34;&#58;@{reason}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>CONN</span>
                                </button>
                                <input name="attr_conn" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_engineering' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Engineering&#34;,&#34;discv&#34;:@{engineering},&#34;attr&#34;:?{Select an Attribute|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Control, &#34;Control&#34;&amp;#44;&#34;attrv&#34;&#58;@{control}|Daring, &#34;Daring&#34;&amp;#44;&#34;attrv&#34;&#58;@{daring}|Fitness, &#34;Fitness&#34;&amp;#44;&#34;attrv&#34;&#58;@{fitness}|Insight, &#34;Insight&#34;&amp;#44;&#34;attrv&#34;&#58;@{insight}|Presence, &#34;Presence&#34;&amp;#44;&#34;attrv&#34;&#58;@{presence}|Reason, &#34;Reason&#34;&amp;#44;&#34;attrv&#34;&#58;@{reason}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>ENGINEERING</span>
                                </button>
                                <input name="attr_engineering" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_medicine' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Medicine&#34;,&#34;discv&#34;:@{medicine},&#34;attr&#34;:?{Select an Attribute|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Control, &#34;Control&#34;&amp;#44;&#34;attrv&#34;&#58;@{control}|Daring, &#34;Daring&#34;&amp;#44;&#34;attrv&#34;&#58;@{daring}|Fitness, &#34;Fitness&#34;&amp;#44;&#34;attrv&#34;&#58;@{fitness}|Insight, &#34;Insight&#34;&amp;#44;&#34;attrv&#34;&#58;@{insight}|Presence, &#34;Presence&#34;&amp;#44;&#34;attrv&#34;&#58;@{presence}|Reason, &#34;Reason&#34;&amp;#44;&#34;attrv&#34;&#58;@{reason}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>MEDICINE</span>
                                </button>
                                <input name="attr_medicine" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='values'>
                    <div class="sectionheader">
                        <span class="label">VALUES</span>
                    </div>
                    <textarea name="attr_values"></textarea>
                </div>
                <div class="determination" style="margin-top: 5px;">
                    <span class="label">DETERMINATION</span>
                    <span class=determination-values>
                        <input type="checkbox" name="attr_det1"/><span></span>
                        <input type="checkbox" name="attr_det2"/><span></span>
                        <input type="checkbox" name="attr_det3"/><span></span>
                    </span>
                </div>
                <div class="momentum" style="margin-top: 8px;">
                    <span class="label">MOMENTUM</span>
                    <span class=momentum-values>
                        <input type="checkbox" name="attr_momentum1"/><span></span>
                        <input type="checkbox" name="attr_momentum2"/><span></span>
                        <input type="checkbox" name="attr_momentum3"/><span></span>
                        <input type="checkbox" name="attr_momentum4"/><span></span>
                        <input type="checkbox" name="attr_momentum5"/><span></span>
                        <input type="checkbox" name="attr_momentum6"/><span></span>
                    </span>
                </div>
                <div class='talents'>
                    <div class="sectionheader">
                        <span class="label">TALENTS</span>
                    </div>
                    <textarea name="attr_talents"></textarea>
                </div>
                <div class='weapons'>
                    <div class="sectionheader">
                        <span class="label">WEAPONS</span>
                    </div>
                    <fieldset class="repeating_weapons">
                        <div class="sheet-row">
                            <div class="weaponscontainer">
                                <span class="label">NAME/TYPE</span><input name="attr_weapname" type="text" style="width: 248px"/>
                            </div>
                            <div class="weaponscontainer">
                                <button type="roll" name="roll_weapon" value="!chaldice &#123;&#34;dice&#34;: @{weapval}&#125;">
                                    <image src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Star%20Trek%20Adventures%202d20/logosmall.png"/>
                                </button>
                                <input name="attr_weapval" type="number" min=1 max=15 value="2"/>
                            </div>
                        </div>
                        <div class="weaponscontainer" style="margin-top: 4px; width: 100%">
                            <span class="label">QUALITIES</span><input name="attr_weaponqualities" type="text"/>
                        </div>
                        <hr/>
                    </fieldset>
                </div>
            </div>
            <div class="sheet-col" style="margin-left: 30px; width: 350px;">
                <div class='focuses'>
                    <div class="sectionheader">
                        <span class="label">FOCUSES</span>
                    </div>
                    <textarea name="attr_focuses"></textarea>
                </div>
                <div class='stress'>
                    <div class="sectionheader">
                        <span class="label">STRESS</span>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-col">
                            <input type="hidden" name="attr_stress_1_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_1"/><span></span>
                            <input type="hidden" name="attr_stress_2_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_2"/><span></span>
                            <input type="hidden" name="attr_stress_3_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_3"/><span></span>
                            <input type="hidden" name="attr_stress_4_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_4"/><span></span>
                            <input type="hidden" name="attr_stress_5_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_5"/><span></span>
                            <input type="hidden" name="attr_stress_6_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_6"/><span></span>
                        </div>
                        <div class="sheet-col">
                            <input type="hidden" name="attr_stress_7_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_7"/><span></span>
                            <input type="hidden" name="attr_stress_8_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_8"/><span></span>
                            <input type="hidden" name="attr_stress_9_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_9"/><span></span>
                            <input type="hidden" name="attr_stress_10_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_10"/><span></span>
                            <input type="hidden" name="attr_stress_11_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_11"/><span></span>
                            <input type="hidden" name="attr_stress_12_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_12"/><span></span>
                        </div>
                        <div class="sheet-col">
                            <input type="hidden" name="attr_stress_13_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_13"/><span></span>
                            <input type="hidden" name="attr_stress_14_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_14"/><span></span>
                            <input type="hidden" name="attr_stress_15_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_15"/><span></span>
                            <input type="hidden" name="attr_stress_16_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_16"/><span></span>
                            <input type="hidden" name="attr_stress_17_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_17"/><span></span>
                            <input type="hidden" name="attr_stress_18_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_18"/><span></span>
                        </div>
                        <div class="sheet-col">
                            <input type="hidden" name="attr_stress_19_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_19"/><span></span>
                            <input type="hidden" name="attr_stress_20_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_20"/><span></span>
                            <input type="hidden" name="attr_stress_21_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_21"/><span></span>
                            <input type="hidden" name="attr_stress_22_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_22"/><span></span>
                            <input type="hidden" name="attr_stress_23_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_23"/><span></span>
                            <input type="hidden" name="attr_stress_24_enabled" value="true"/>
                            <input type="checkbox" name="attr_stress_24"/><span></span>
                        </div>
                    </div>
                </div>
                <div class='injuries'>
                    <div class="sectionheader">
                        <span class="label">INJURIES</span>
                    </div>
                    <textarea name="attr_injuries"></textarea>
                </div>
                <div class='other_equipment'>
                    <div class="sectionheader">
                        <span class="label">OTHER EQUIPMENT</span>
                    </div>
                    <textarea name="attr_other-equip"></textarea>
                </div>
            </div>
            <div class="legal">
                &trade; & &copy; 2017 CBS Studios Inc. &copy; 2017 Paramount Pictures Corp. STAR TREK and related marks and logos are trademarks of CBS Studios Inc. All Rights Reserved.
            </div>
        </div>
    </div>
    <div class='spacer'></div>
</div>
<div class="bottomback starship">
    <div class="bottomsection">
        <div class="sheet-row">
            <div class="sheet-col" style="margin-right: 25px;">
                <div class='attributes'>
                    <div class="sectionheader">
                        <span class="label">SYSTEMS</span>
                    </div>
                    <div class="sheet-row">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_engines' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Engines&#34;,&#34;attrv&#34;:@{ship_engines},&#34;disc&#34;:?{Select a Department|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                   <span>ENGINES</span>
                                </button>
                                <input name="attr_ship_engines" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_engine_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_engine_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_computers' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Computers&#34;,&#34;attrv&#34;:@{ship_computers},&#34;disc&#34;:?{Select a Department|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>COMPUTERS</span>
                                </button>
                                <input name="attr_ship_computers" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_computer_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_computer_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_weapons' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Weapons&#34;,&#34;attrv&#34;:@{ship_weapons},&#34;disc&#34;:?{Select a Department|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>WEAPONS</span>
                                </button>
                                <input name="attr_ship_weapons" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_weapons_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_weapons_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_structure' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Structure&#34;,&#34;attrv&#34;:@{ship_structure},&#34;disc&#34;:?{Select a Department|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                   <span>STRUCTURE</span>
                                </button>
                                <input name="attr_ship_structure" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_structure_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_structure_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_sensors' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Sensors&#34;,&#34;attrv&#34;:@{ship_sensors},&#34;disc&#34;:?{Select a Department|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>SENSORS</span>
                                </button>
                                <input name="attr_ship_sensors" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_sensors_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_sensors_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_communications' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;attr&#34;:&#34;Comms&#34;,&#34;attrv&#34;:@{ship_comms},&#34;disc&#34;:?{Select a Department|None, &#34;Unspecified&#34;&amp;#44;&#34;discv&#34;&#58;0|Command, &#34;Command&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_command}|Conn, &#34;Conn&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_conn}|Security, &#34;Security&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_security}|Engineering, &#34;Engineering&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_engineering}|Science, &#34;Science&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_science}|Medicine, &#34;Medicine&#34;&amp;#44;&#34;discv&#34;&#58;@{ship_medicine}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>COMMS</span>
                                </button>
                                <input name="attr_ship_comms" type="number" min=7 max=12 value="7"/>
                                <div class="breaches">
                                    <span class=label>BREACHES</span>
                                    <input type="checkbox" name="attr_communications_breach_1"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_2"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_3"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_4"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_5"/><span></span>
                                    <input type="checkbox" name="attr_communications_breach_6"/><span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='departments'>
                    <div class="sectionheader">
                        <span class="label">DEPARTMENTS</span>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_command' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Command&#34;,&#34;discv&#34;:@{ship_command},&#34;attr&#34;:?{Select a System|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Communications, &#34;Comms&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_comms}|Computers, &#34;Computers&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_computers}|Engines, &#34;Engines&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_engines}|Sensors, &#34;Sensors&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_sensors}|Structure, &#34;Structure&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_structure}|Weapons, &#34;Weapons&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_weapons}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>COMMAND</span>
                                </button>
                                <input name="attr_ship_command" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_security' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Security&#34;,&#34;discv&#34;:@{ship_security},&#34;attr&#34;:?{Select a System|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Communications, &#34;Comms&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_comms}|Computers, &#34;Computers&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_computers}|Engines, &#34;Engines&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_engines}|Sensors, &#34;Sensors&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_sensors}|Structure, &#34;Structure&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_structure}|Weapons, &#34;Weapons&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_weapons}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>SECURITY</span>
                                </button>
                                <input name="attr_ship_security" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_science' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Science&#34;,&#34;discv&#34;:@{ship_science},&#34;attr&#34;:?{Select a System|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Communications, &#34;Comms&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_comms}|Computers, &#34;Computers&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_computers}|Engines, &#34;Engines&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_engines}|Sensors, &#34;Sensors&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_sensors}|Structure, &#34;Structure&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_structure}|Weapons, &#34;Weapons&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_weapons}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>SCIENCE</span>
                                </button>
                                <input name="attr_ship_science" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-row" style="margin-top: 10px;">
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_conn' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Conn&#34;,&#34;discv&#34;:@{ship_conn},&#34;attr&#34;:?{Select a System|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Communications, &#34;Comms&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_comms}|Computers, &#34;Computers&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_computers}|Engines, &#34;Engines&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_engines}|Sensors, &#34;Sensors&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_sensors}|Structure, &#34;Structure&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_structure}|Weapons, &#34;Weapons&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_weapons}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>CONN</span>
                                </button>
                                <input name="attr_ship_conn" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_engineering' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Engineering&#34;,&#34;discv&#34;:@{ship_engineering},&#34;attr&#34;:?{Select a System|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Communications, &#34;Comms&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_comms}|Computers, &#34;Computers&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_computers}|Engines, &#34;Engines&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_engines}|Sensors, &#34;Sensors&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_sensors}|Structure, &#34;Structure&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_structure}|Weapons, &#34;Weapons&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_weapons}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>ENGINEERING</span>
                                </button>
                                <input name="attr_ship_engineering" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                        <div class="sheet-col">
                            <div class="attributecontainer">
                                <button type='roll' name='roll_ship_medicine' value="!taskdice &#123;&#34;diff&#34;:?{Task Difficulty|1},&#34;disc&#34;:&#34;Medicine&#34;,&#34;discv&#34;:@{ship_medicine},&#34;attr&#34;:?{Select a System|None, &#34;None&#34;&amp;#44;&#34;attrv&#34;&#58;0|Communications, &#34;Comms&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_comms}|Computers, &#34;Computers&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_computers}|Engines, &#34;Engines&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_engines}|Sensors, &#34;Sensors&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_sensors}|Structure, &#34;Structure&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_structure}|Weapons, &#34;Weapons&#34;&amp;#44;&#34;attrv&#34;&#58;@{ship_weapons}},&#34;focus&#34;:?{Focus Applicable?|false|true},&#34;dice&#34;:?{Number of Dice|2},&#34;cr&#34;:?{Complications Threshold|20}&#125;">
                                    <span>MEDICINE</span>
                                </button>
                                <input name="attr_ship_medicine" type="number" min=0 max=5 value="0"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='talents'>
                    <div class="sectionheader">
                        <span class="label">TALENTS</span>
                    </div>
                    <textarea name="attr_ship_talents"></textarea>
                </div>
            </div>
            <div class="sheet-col">
                <div class="scale">
                    <div class="attributecontainer">
                        <span class="label">SCALE</span><input type="number" name="attr_ship_scale" min=1 max=20 value="1"/>
                    </div>
                </div>
                <div class="sheet-row">
                    <div class="sheet-col" style="margin-right: 20px;">
                        <div class='power'>
                            <div class="sectionheader">
                                <span class="label">POWER</span>
                            </div>
                            <div class="sheet-row" style="margin-top: 10px">
                                <div class="sheet-col">
                                    <div class="attributecontainer">
                                        <span class="label">CURRENT</span><input name="attr_power" type="number" min=0 value="7"/>
                                    </div>
                                </div>
                                <div class="sheet-col">
                                    <div class="attributecontainer">
                                        <span class="label">TOTAL</span><input name="attr_power_max" type="number" disabled="true" value="@{ship_engines} + @{power_bonus}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class='shields'>
                            <div class="sectionheader">
                                <span class="label">SHIELDS</span>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_1_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_1" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_2_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_2" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_3_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_3" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_4_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_4" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_5_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_5" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_6_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_6" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_7_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_7" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_8_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_8" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_9_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_9" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_10_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_10" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_11_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_11" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_12_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_12" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_13_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_13" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_14_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_14" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_15_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_15" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_16_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_16" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_17_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_17" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_18_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_18" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_19_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_19" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_20_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_20" value="on" checked/><span></span>
                                </div>
                            </div>
                            <div class="sheet-row">
                                <div class="sheet-col">
                                    <input type="hidden" name="attr_shields_21_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_21" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_22_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_22" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_23_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_23" value="on" checked/><span></span>
                                    <input type="hidden" name="attr_shields_24_enabled" value="true"/>
                                    <input type="checkbox" name="attr_shields_24" value="on" checked/><span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sheet-col">
                        <div class='launch-bay'>
                            <div class="sectionheader">
                                <span class="label">LAUNCH BAY</span>
                            </div>
                            <textarea name="attr_launch_bay"></textarea>
                        </div>
                        <div class='crew'>
                            <div class="sectionheader">
                                <span class="label">CREW SUPPORT</span>
                            </div>
                            <div class="sheet-row" style="margin-top: 10px">
                                <div class="sheet-col">
                                    <div class="attributecontainer">
                                        <span class="label">CURRENT</span><input name="attr_crew" type="number" min=0 max=5 value="0"/>
                                    </div>
                                </div>
                                <div class="sheet-col">
                                    <div class="attributecontainer">
                                        <span class="label">TOTAL</span><input name="attr_crew_max" type="number" disabled="true" value="@{scale}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='weapons'>
                    <div class="sectionheader">
                        <span class="label">WEAPONS</span>
                    </div>
                    <fieldset class="repeating_weapons">
                        <div class="sheet-row">
                            <div class="weaponscontainer">
                                <span class="label">NAME/TYPE</span><input name="attr_weapname" type="text" style="width: 362px"/>
                            </div>
                            <div class="weaponscontainer">
                                <button type="roll" name="roll_weapon" value="!chaldice &#123;&#34;dice&#34;: @{weapval}&#125;">
                                    <image src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Star%20Trek%20Adventures%202d20/logosmall.png"/>
                                </button>
                                <input name="attr_weapval" type="number" min=1 max=15 value="2"/>
                            </div>
                        </div>
                        <div class="weaponscontainer" style="margin-top: 4px; width: 100%">
                            <span class="label">QUALITIES</span><input name="attr_weaponqualities" type="text"/>
                        </div>
                        <hr/>
                    </fieldset>
                </div>
            </div>
        </div>
        <div class="legal">
            &trade; & &copy; 2017 CBS Studios Inc. &copy; 2017 Paramount Pictures Corp. STAR TREK and related marks and logos are trademarks of CBS Studios Inc. All Rights Reserved.
        </div>
    </div>
    <div class='spacer'></div>
    </div>
</div>

<!--ROLL TEMPLATES-->

<div class="rolltemplates">
    <rolltemplate class="sheet-rolltemplate-lcars">
        <table>
            <tr><th>{{#roll_name}}{{roll_name}}{{/roll_name}}</th></tr>
            <tr><td class="diff">
                {{#diff_num}}
                    Task Difficulty: {{diff_num}}
                {{/diff_num}}
            </td></tr>
            <tr><td class="attr">
                {{#attr}}
                    {{attr}}: {{attr_num}}
                {{/attr}}
            </td></tr>
            <tr><td class="discp">
                {{#discp}}
                     {{discp}}: {{discp_num}}
                {{/discp}}
            </td></tr>
            <tr>
                <td class="result">{{result}} Successes</td>        
            </tr> 
        </table>
    </rolltemplate>
    <rolltemplate class="sheet-rolltemplate-challengeroll">
        <table><tr><th></th></tr></table>
    </rolltemplate>
</div>


<!-- WORKERS -->
<script type="text/worker">

    on("sheet:opened", function () {
        versioning();
        var backgrounds = ['white','#','black']
        getAttrs(["use_background"], function (v) {
            document.getElementsByClassName('charsheet')[0].style.backgroundColor = backgrounds[v.use_background];
        })
        
    });
    
    on("change:use_background", function () {
        var backgrounds = ['white','#','black']
        getAttrs(["use_background"], function (v) {
            document.getElementsByClassName('charsheet')[0].style.backgroundColor = backgrounds[v.use_background];
        })
    })
    
    on("change:show_settings change:show_settings_max", function () {
        getAttrs(["show_settings"], function (v) {
            if (v.show_settings === "on") {
                setAttrs({"settings_toggle": "on"});
            } else {
                setAttrs({"settings_toggle": 0});
            }
        });
    });
    
    on("change:stress_max", function () {
        configure_stress();
    });
    
    on("change:shields_max", function () {
        configure_shields();
    });
    
    on("change:stress_1 change:stress_2 change:stress_3 change:stress_4 change:stress_5 change:stress_6 change:stress_7 change:stress_8 change:stress_9 change:stress_10 change:stress_11 change:stress_12 change:stress_13 change:stress_14 change:stress_15 change:stress_16 change:stress_17 change:stress_18 change:stress_19 change:stress_20 change:stress_21 change:stress_22 change:stress_23 change:stress_24", function () {
        count_stress();
    });
    
    on("change:shields_1 change:shields_2 change:shields_3 change:shields_4 change:shields_5 change:shields_6 change:shields_7 change:shields_8 change:shields_9 change:shields_10 change:shields_11 change:shields_12 change:shields_13 change:shields_14 change:shields_15 change:shields_16 change:shields_17 change:shields_18 change:shields_19 change:shields_20 change:shields_21 change:shields_22 change:shields_23 change:shields_24", function () {
        count_shields();
    });
    
    on("change:stress", function () {
        update_stress();
    });
    
    on("change:shields", function () {
        update_shields();
    });
    
    on("change:header_text", function () {
        getAttrs(["header_text"], function (v) {
            if (v.header_text && v.header_text === "starship") {
                setAttrs({
                    "character_type": "starship"
                });
            } else if (v.header_text && v.header_text === "settings") {
                setAttrs({
                    "character_type": "settings"
                });
            } else {
                setAttrs({
                    "character_type": "character"
                });
            }
        });
    });
    
    var configure_stress = function () {
    
        getAttrs(["fitness", "security", "stress_bonus"], function (v) {
            var attrs = {};
            var fit = parseInt(v.fitness) || 0;
            var sec = parseInt(v.security) || 0;
            var bon = parseInt(v.stress_bonus) || 0;
            var tot = fit + sec + bon;
    
            for (i = 1; i <= tot; i += 1) {
                attrs["stress_".concat(i, "_enabled")] = "true";
            }
    
            for (i = tot + 1; i <= 24; i += 1) {
                attrs["stress_".concat(i)] = 0;
                attrs["stress_".concat(i, "_enabled")] = "false";
            }
    
            setAttrs(attrs);
        });
    };
    
    var configure_shields = function () {
    
        getAttrs(["ship_structure", "ship_security", "shields_bonus"], function (v) {
            var attrs = {};
            var str = parseInt(v.ship_structure) || 0;
            var sec = parseInt(v.ship_security) || 0;
            var bon = parseInt(v.shields_bonus) || 0;
            var tot = str + sec + bon;
            for (i = 1; i <= tot; i+=1) {
                attrs["shields_".concat(i, "_enabled")] = "true";
            }
            for (i = tot + 1; i <= 24; i+=1) {
                attrs["shields_".concat(i)] = 0;
                attrs["shields_".concat(i, "_enabled")] = "false";
            }
            setAttrs(attrs);
        });
    };
    
    var do_checkbox_count = function (checkboxen) {
        var total = 0;
        Object.keys(checkboxen).forEach(function (key) {
            if (checkboxen[key] === "on") {
                total += 1;
            }
        });
        return total;
    };
    
    var get_attr_list = function (attr_name, attr_count) {
        var attr_list = [];
        for (i = 0; i <= attr_count; i+=1) {
            attr_list.push(attr_name.concat("_", i));
        }
        return attr_list;
    };
    
    var count_stress = function() {
        getAttrs(get_attr_list("stress", 24), function(v) {
            setAttrs({"stress": do_checkbox_count(v)});
        });
    };
    
    var count_shields = function() {
        getAttrs(get_attr_list("shields", 24), function (v) {
            setAttrs({"shields": do_checkbox_count(v)});
        });
    };
    
    var update_stress = function () {
        var attr_list = ["stress"];
        attr_list = attr_list.concat(get_attr_list("stress", 24));
        getAttrs(attr_list, function (v) {
            update_checkbox_things("stress", v);
        });
    };
    
    var update_shields = function () {
        var attr_list = ["shields"];
        attr_list = attr_list.concat(get_attr_list("shields", 24));
        getAttrs(attr_list, function (v) {
            update_checkbox_things("shields", v);
        });
    };
    
    var update_checkbox_things = function (skip_attr, v) {
        var newval = parseInt(v[skip_attr]);
        var curval = do_checkbox_count(v);
        var attrs = {};
        if (newval === 0) {
            Object.keys(v).forEach(function (key) {
                if (key !== skip_attr){
                    attrs[key] = 0;
                }
            });
            setAttrs(attrs);
            return;
        }
        var diff = (newval - curval);
        if (diff < 0) {
            // reverse the key order (yeah, yeah, this isn't great but works)
            var revkeys = [];
            Object.keys(v).forEach(function (key) {
                revkeys.unshift(key);
            });
            for (i = 0; i<revkeys.length; i+=1) {
                if (revkeys[i] !== skip_attr) {
                    if (v[revkeys[i]] === "on") {
                        attrs[revkeys[i]] = 0;
                        diff ++;
                    }
                    if (diff === 0) {
                        break;
                    }
                }
            }
        }
        if (diff > 0) {
            Object.keys(v).forEach(function(key) {
                if (diff > 0 && key !== skip_attr) {
                    if (v[key] != "on") {
                        attrs[key] = "on";
                        diff --;
                    }
                }
            });
        }
        setAttrs(attrs);
    };
    
    var versioning = function () {
        getAttrs(["version"], function (v) {
            console.log("CURRENT VERSION IS: ".concat(v.version));
            if (!v["version"] || v["version"] === "" ) {
                update_to_1_1();
            } else if(v["version"] == "1.1") {
                update_to_1_2();
            } else {
                setAttrs({"version": "1.2"});
                console.log("Star Trek Adventures 2d20 version " + v.version);
            }
        });
    };
    
    var update_to_1_1 = function () {
        console.log("UPDATING TO SHEET VERSION 1.1");
        configure_stress();
        configure_shields();
        getAttrs(["wep1_name", "wep1_dr", "wep1_qualities", "wep2_name", "wep2_dr", "wep2_qualities", "wep3_name", "wep3_dr", "wep3_qualities"], function (v){
            update_dyanamic_weapon(v.wep1_name, v.wep1_dr, v.wep1_qualities);
            update_dyanamic_weapon(v.wep2_name, v.wep2_dr, v.wep2_qualities);
            update_dyanamic_weapon(v.wep3_name, v.wep3_dr, v.wep3_qualities);
            setAttrs({"version": "1.1"});
            console.log("Star Trek Adventures 2d20 version " + v.version);
        });
    };
    
    var update_to_1_2 = function () {
        console.log("UPDATE TO SHEET VERSION 1.2");
        setAttrs({"version":"1.2","use_background":"white"})
        console.log("Star Trek Adventures 2d20 version " + v.version);        
    }
        
    
    var update_dyanamic_weapon = function (wep_name, wep_dr, wep_qual) {
        if (wep_name) {
            var newrowid= generateRowID();
            var new_attrs = {};
            new_attrs["repeating_weapons_" + newrowid + "_weapname"] = wep_name;
            new_attrs["repeating_weapons_" + newrowid + "_weapval"] = wep_dr;
            new_attrs["repeating_weapons_" + newrowid + "_weaponqualities"] = wep_qual;
            setAttrs(new_attrs);
        }
    };
    
</script>
